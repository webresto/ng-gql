!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("apollo-angular"),require("rxjs"),require("rxjs/operators"),require("apollo-angular/http"),require("@apollo/client/core"),require("@apollo/client/link/ws"),require("@apollo/client/utilities")):"function"==typeof define&&define.amd?define("@webresto/ng-gql",["exports","@angular/core","apollo-angular","rxjs","rxjs/operators","apollo-angular/http","@apollo/client/core","@apollo/client/link/ws","@apollo/client/utilities"],e):e(((t="undefined"!=typeof globalThis?globalThis:t||self).webresto=t.webresto||{},t.webresto["ng-gql"]={}),t.ng.core,t.i1,t.rxjs,t.rxjs.operators,t.http,t.core,t.ws,t.utilities)}(this,(function(t,e,n,r,i,o,s,a,d){"use strict";var h=function(){},c=function(){},u=function(){},p=function(){},m=function(){},l=function(){},f=function(){},g=function(){},v=function(){this.totalAmount=0},y=function(){};Object.create;function C(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}Object.create;var M,D,$,b,S,k,w,F,P,E,T,q,A,x,L,G,j,O,H,B,N,Q,R,W,_={image:n.gql(M||(M=I(["\n\t\tfragment ImageFragment on Image {\n\t\t\tid\n\t\t\tuploadDate\n\t\t\timages\n\t\t}\n\t"],["\n\t\tfragment ImageFragment on Image {\n\t\t\tid\n\t\t\tuploadDate\n\t\t\timages\n\t\t}\n\t"])))},z={modifier:n.gql(D||(D=I(["\n\t\tfragment ModifierFragment on Modifier {\n\t\t\tmodifierId\n\t\t\tmaxAmount\n\t\t\tminAmount\n\t\t\tdefaultAmount\n\t\t\thideIfDefaultAmount\n\t\t\tdish {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tgroupId\n\t\t\t\tprice\n\t\t\t\tweight\n\t\t\t\tbalance\n\t\t\t\ttags\n\t\t\t\timages {\n\t\t\t\t\t...ImageFragment\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t","\n\t"],["\n\t\tfragment ModifierFragment on Modifier {\n\t\t\tmodifierId\n\t\t\tmaxAmount\n\t\t\tminAmount\n\t\t\tdefaultAmount\n\t\t\thideIfDefaultAmount\n\t\t\tdish {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t\tdescription\n\t\t\t\tgroupId\n\t\t\t\tprice\n\t\t\t\tweight\n\t\t\t\tbalance\n\t\t\t\ttags\n\t\t\t\timages {\n\t\t\t\t\t...ImageFragment\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t","\n\t"])),_.image)},V={groupModifier:n.gql($||($=I(["\n\t\tfragment GroupModifierFragment on GroupModifier {\n\t\t\tmodifierId\n\t\t\tmaxAmount\n\t\t\tminAmount\n\t\t\trequired\n\t\t\tchildModifiers {\n\t\t\t\t...ModifierFragment\n\t\t\t}\n\t\t\tgroup {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t}\n\t\t","\n\t"],["\n\t\tfragment GroupModifierFragment on GroupModifier {\n\t\t\tmodifierId\n\t\t\tmaxAmount\n\t\t\tminAmount\n\t\t\trequired\n\t\t\tchildModifiers {\n\t\t\t\t...ModifierFragment\n\t\t\t}\n\t\t\tgroup {\n\t\t\t\tid\n\t\t\t\tname\n\t\t\t}\n\t\t}\n\t\t","\n\t"])),z.modifier)},J={dish:n.gql(b||(b=I(["\n\t\tfragment DishFragment on Dish {\n\t\t\tid\n\t\t\tname\n\t\t\tdescription\n\t\t\tgroupId\n\t\t\tprice\n\t\t\tweight\n\t\t\tbalance\n\t\t\ttags\n\t\t\tadditionalInfo\n\t\t\timages {\n\t\t\t\t...ImageFragment\n\t\t\t}\n\t\t\tmodifiers {\n\t\t\t\t...GroupModifierFragment\n\t\t\t}\n\t\t\tparentGroup {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t\t","\n\t\t","\n\t"],["\n\t\tfragment DishFragment on Dish {\n\t\t\tid\n\t\t\tname\n\t\t\tdescription\n\t\t\tgroupId\n\t\t\tprice\n\t\t\tweight\n\t\t\tbalance\n\t\t\ttags\n\t\t\tadditionalInfo\n\t\t\timages {\n\t\t\t\t...ImageFragment\n\t\t\t}\n\t\t\tmodifiers {\n\t\t\t\t...GroupModifierFragment\n\t\t\t}\n\t\t\tparentGroup {\n\t\t\t\tid\n\t\t\t}\n\t\t}\n\t\t","\n\t\t","\n\t"])),_.image,V.groupModifier)},U={getDishes:function(){return n.gql(S||(S=I(["\n\t\t\tquery GetDishes {\n\t\t\t\tdishes {\n\t\t\t\t\t...DishFragment\n\t\t\t\t}\n\t\t\t}\n\t\t\t","\n\t\t"],["\n\t\t\tquery GetDishes {\n\t\t\t\tdishes {\n\t\t\t\t\t...DishFragment\n\t\t\t\t}\n\t\t\t}\n\t\t\t","\n\t\t"])),J.dish)}},K={cartDish:n.gql(k||(k=I(["\n\t\tfragment CartDishFragment on CartDish {\n\t\t\tid\n\t\t\tamount\n\t\t\tdish {\n\t\t\t\t...DishFragment\n\t\t\t}\n\t\t\tmodifiers {\n\t\t\t\tid\n\t\t\t\tdish {\n\t\t\t\t\t...DishFragment\n\t\t\t\t}\n\t\t\t\tamount\n\t\t\t\tgroupId\n\t\t\t}\n\t\t\tdiscountTotal\n\t\t\tcomment\n\t\t\tweight\n\t\t\ttotalWeight\n\t\t}\n\t\t","\n\t"],["\n\t\tfragment CartDishFragment on CartDish {\n\t\t\tid\n\t\t\tamount\n\t\t\tdish {\n\t\t\t\t...DishFragment\n\t\t\t}\n\t\t\tmodifiers {\n\t\t\t\tid\n\t\t\t\tdish {\n\t\t\t\t\t...DishFragment\n\t\t\t\t}\n\t\t\t\tamount\n\t\t\t\tgroupId\n\t\t\t}\n\t\t\tdiscountTotal\n\t\t\tcomment\n\t\t\tweight\n\t\t\ttotalWeight\n\t\t}\n\t\t","\n\t"])),J.dish)},X={cart:n.gql(w||(w=I(["\n\t\tfragment CartFragment on Cart {\n\t\t\tid\n\t\t\tdishesCount\n\t\t\tcomment\n\t\t\tpersonsCount\n\t\t\tdeliveryDescription\n\t\t\tmessage\n\t\t\tdeliveryCost\n\t\t\ttotalWeight\n\t\t\ttotal\n\t\t\torderTotal\n\t\t\tcartTotal\n\t\t\tdiscountTotal\n\t\t\tstate\n\t\t}\n\t"],["\n\t\tfragment CartFragment on Cart {\n\t\t\tid\n\t\t\tdishesCount\n\t\t\tcomment\n\t\t\tpersonsCount\n\t\t\tdeliveryDescription\n\t\t\tmessage\n\t\t\tdeliveryCost\n\t\t\ttotalWeight\n\t\t\ttotal\n\t\t\torderTotal\n\t\t\tcartTotal\n\t\t\tdiscountTotal\n\t\t\tstate\n\t\t}\n\t"])))},Y={getCart:function(t){void 0===t&&(t=null),"null"==t&&(t=null);var e=t?'(cartId: "'+t+'")':"";return n.gql(F||(F=I(["\n\t\t\t\tquery GetCart {\n\t\t\t\t\tcart"," {\n\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\tdishes {\n\t\t\t\t\t\t\t...CartDishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdeliveryItem {\n\t\t\t\t\t\t\t...DishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t"],["\n\t\t\t\tquery GetCart {\n\t\t\t\t\tcart"," {\n\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\tdishes {\n\t\t\t\t\t\t\t...CartDishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdeliveryItem {\n\t\t\t\t\t\t\t...DishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t"])),e,X.cart,K.cartDish,J.dish)},getPhone:function(t){return n.gql(P||(P=I(['\n\t\t\t\tquery phone {\n\t\t\t\t\tphone(phone: "','") {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tphone\n\t\t\t\t\t\tisFirst\n\t\t\t\t\t\tisConfirm\n\t\t\t\t\t\tcodeTime\n\t\t\t\t\t\tconfirmCode\n\t\t\t\t\t\tcustomData\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t'],['\n\t\t\t\tquery phone {\n\t\t\t\t\tphone(phone: "','") {\n\t\t\t\t\t\tid\n\t\t\t\t\t\tphone\n\t\t\t\t\t\tisFirst\n\t\t\t\t\t\tisConfirm\n\t\t\t\t\t\tcodeTime\n\t\t\t\t\t\tconfirmCode\n\t\t\t\t\t\tcustomData\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t'])),t)},checkPhone:function(t){return n.gql(E||(E=I(['\n\t\t\t\tquery checkPhone {\n\t\t\t\t\tcheckPhone(phone: "','") {\n\t\t\t\t\t\ttype\n\t\t\t\t\t\ttitle\n\t\t\t\t\t\tmessage\n\t\t\t\t\t\tconfirmed\n\t\t\t\t\t\tfirstbuy\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t'],['\n\t\t\t\tquery checkPhone {\n\t\t\t\t\tcheckPhone(phone: "','") {\n\t\t\t\t\t\ttype\n\t\t\t\t\t\ttitle\n\t\t\t\t\t\tmessage\n\t\t\t\t\t\tconfirmed\n\t\t\t\t\t\tfirstbuy\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t'])),t)}},Z={addDishToCart:function(){return n.gql(T||(T=I(["\n\t\t\t\tmutation AddDishToCart(\n\t\t\t\t\t$cartId: String, \n\t\t\t\t\t$dishId: String, \n\t\t\t\t\t$amount: Int, \n\t\t\t\t\t$modifiers: Json, \n\t\t\t\t\t$comment: String,\n\t\t\t\t\t$from: String,\n\t\t\t\t\t$replace: Boolean,\n\t\t\t\t\t$cartDishId: String\n\t\t\t\t) {\n\t\t\t\t\tcartAddDish(\n\t\t\t\t\t\tcartId: $cartId,\n\t\t\t\t\t\tdishId: $dishId,\n\t\t\t\t\t\tamount: $amount,\n\t\t\t\t\t\tmodifiers: $modifiers,\n\t\t\t\t\t\tcomment: $comment,\n\t\t\t\t\t\tfrom: $from,\n\t\t\t\t\t\treplace: $replace,\n\t\t\t\t\t\tcartDishId: $cartDishId\n\t\t\t\t\t) {\n\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\tdishes {\n\t\t\t\t\t\t\t...CartDishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdeliveryItem {\n\t\t\t\t\t\t\t...DishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t"],["\n\t\t\t\tmutation AddDishToCart(\n\t\t\t\t\t$cartId: String, \n\t\t\t\t\t$dishId: String, \n\t\t\t\t\t$amount: Int, \n\t\t\t\t\t$modifiers: Json, \n\t\t\t\t\t$comment: String,\n\t\t\t\t\t$from: String,\n\t\t\t\t\t$replace: Boolean,\n\t\t\t\t\t$cartDishId: String\n\t\t\t\t) {\n\t\t\t\t\tcartAddDish(\n\t\t\t\t\t\tcartId: $cartId,\n\t\t\t\t\t\tdishId: $dishId,\n\t\t\t\t\t\tamount: $amount,\n\t\t\t\t\t\tmodifiers: $modifiers,\n\t\t\t\t\t\tcomment: $comment,\n\t\t\t\t\t\tfrom: $from,\n\t\t\t\t\t\treplace: $replace,\n\t\t\t\t\t\tcartDishId: $cartDishId\n\t\t\t\t\t) {\n\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\tdishes {\n\t\t\t\t\t\t\t...CartDishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdeliveryItem {\n\t\t\t\t\t\t\t...DishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t"])),X.cart,K.cartDish,J.dish)},removeDishFromCart:function(){return n.gql(q||(q=I(["\n\t\t\t\tmutation cartRemoveDish(\n\t\t\t\t\t$cartId: String!, \n\t\t\t\t\t$cartDishId: Int!, \n\t\t\t\t\t$amount: Int!, \n\t\t\t\t) {\n\t\t\t\t\tcartRemoveDish(\n\t\t\t\t\t\tid: $cartId,\n\t\t\t\t\t\tcartDishId: $cartDishId,\n\t\t\t\t\t\tamount: $amount,\n\t\t\t\t\t) {\n\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\tdishes {\n\t\t\t\t\t\t\t...CartDishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdeliveryItem {\n\t\t\t\t\t\t\t...DishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t"],["\n\t\t\t\tmutation cartRemoveDish(\n\t\t\t\t\t$cartId: String!, \n\t\t\t\t\t$cartDishId: Int!, \n\t\t\t\t\t$amount: Int!, \n\t\t\t\t) {\n\t\t\t\t\tcartRemoveDish(\n\t\t\t\t\t\tid: $cartId,\n\t\t\t\t\t\tcartDishId: $cartDishId,\n\t\t\t\t\t\tamount: $amount,\n\t\t\t\t\t) {\n\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\tdishes {\n\t\t\t\t\t\t\t...CartDishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tdeliveryItem {\n\t\t\t\t\t\t\t...DishFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t\t","\n\t\t\t"])),X.cart,K.cartDish,J.dish)},orderCart:function(){return n.gql(A||(A=I(["\n\t\t\t\tmutation orderCart(\n\t\t\t\t\t$cartId: String!, \n\t\t\t\t\t$paymentMethodId: String!,\n\t\t\t\t\t$selfService: Boolean,\n\t\t\t\t\t$address: Address,\n\t\t\t\t\t$customer: Customer!\n\t\t\t\t) {\n\t\t\t\t\torderCart(\n\t\t\t\t\t\tcartId: $cartId,\n\t\t\t\t\t\tpaymentMethodId: $paymentMethodId,\n\t\t\t\t\t\tselfService: $selfService,\n\t\t\t\t\t\taddress: $address,\n\t\t\t\t\t\tcustomer: $customer\n\t\t\t\t\t) {\n\t\t\t\t\t\tcart {\n\t\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmessage {\n\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tmessage\n\t\t\t\t\t\t}\n\t\t\t\t\t\taction {\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tdata\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t"],["\n\t\t\t\tmutation orderCart(\n\t\t\t\t\t$cartId: String!, \n\t\t\t\t\t$paymentMethodId: String!,\n\t\t\t\t\t$selfService: Boolean,\n\t\t\t\t\t$address: Address,\n\t\t\t\t\t$customer: Customer!\n\t\t\t\t) {\n\t\t\t\t\torderCart(\n\t\t\t\t\t\tcartId: $cartId,\n\t\t\t\t\t\tpaymentMethodId: $paymentMethodId,\n\t\t\t\t\t\tselfService: $selfService,\n\t\t\t\t\t\taddress: $address,\n\t\t\t\t\t\tcustomer: $customer\n\t\t\t\t\t) {\n\t\t\t\t\t\tcart {\n\t\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmessage {\n\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tmessage\n\t\t\t\t\t\t}\n\t\t\t\t\t\taction {\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tdata\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t"])),X.cart)},checkCart:function(){return n.gql(x||(x=I(["\n\t\t\t\tmutation checkCart(\n\t\t\t\t\t$cartId: String!, \n\t\t\t\t\t$paymentMethodId: String!,\n\t\t\t\t\t$selfService: Boolean,\n\t\t\t\t\t$address: Address,\n\t\t\t\t\t$customer: Customer!\n\t\t\t\t) {\n\t\t\t\t\tcheckCart(\n\t\t\t\t\t\tcartId: $cartId,\n\t\t\t\t\t\tpaymentMethodId: $paymentMethodId,\n\t\t\t\t\t\tselfService: $selfService,\n\t\t\t\t\t\taddress: $address,\n\t\t\t\t\t\tcustomer: $customer\n\t\t\t\t\t) {\n\t\t\t\t\t\tcart {\n\t\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmessage {\n\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tmessage\n\t\t\t\t\t\t}\n\t\t\t\t\t\taction {\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tdata\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t"],["\n\t\t\t\tmutation checkCart(\n\t\t\t\t\t$cartId: String!, \n\t\t\t\t\t$paymentMethodId: String!,\n\t\t\t\t\t$selfService: Boolean,\n\t\t\t\t\t$address: Address,\n\t\t\t\t\t$customer: Customer!\n\t\t\t\t) {\n\t\t\t\t\tcheckCart(\n\t\t\t\t\t\tcartId: $cartId,\n\t\t\t\t\t\tpaymentMethodId: $paymentMethodId,\n\t\t\t\t\t\tselfService: $selfService,\n\t\t\t\t\t\taddress: $address,\n\t\t\t\t\t\tcustomer: $customer\n\t\t\t\t\t) {\n\t\t\t\t\t\tcart {\n\t\t\t\t\t\t\t...CartFragment\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmessage {\n\t\t\t\t\t\t\ttitle\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tmessage\n\t\t\t\t\t\t}\n\t\t\t\t\t\taction {\n\t\t\t\t\t\t\ttype\n\t\t\t\t\t\t\tdata\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t"])),X.cart)},checkPhoneCode:function(){return n.gql(L||(L=I(["\n\t\t\t\tmutation checkPhoneCode(\n\t\t\t\t\t$phone: String!,\n\t\t\t\t\t$code: String!\n\t\t\t\t) {\n\t\t\t\t\tcheckPhoneCode(\n\t\t\t\t\t\tphone: $phone,\n\t\t\t\t\t\tcode: $code\n\t\t\t\t\t) {\n\t\t\t\t\t\ttype\n\t\t\t\t\t\ttitle\n\t\t\t\t\t\tmessage\n\t\t\t\t\t\tconfirmed\n\t\t\t\t\t\tfirstbuy\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t"],["\n\t\t\t\tmutation checkPhoneCode(\n\t\t\t\t\t$phone: String!,\n\t\t\t\t\t$code: String!\n\t\t\t\t) {\n\t\t\t\t\tcheckPhoneCode(\n\t\t\t\t\t\tphone: $phone,\n\t\t\t\t\t\tcode: $code\n\t\t\t\t\t) {\n\t\t\t\t\t\ttype\n\t\t\t\t\t\ttitle\n\t\t\t\t\t\tmessage\n\t\t\t\t\t\tconfirmed\n\t\t\t\t\t\tfirstbuy\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t"])))}},tt={group:n.gql(G||(G=I(["\n\t\tfragment GroupFragment on Group {\n\t\t\tid\n\t\t\tdescription\n\t\t\tname\n\t\t\torder\n\t\t\tvisible\n\t\t\tslug\n\t\t}\n\t"],["\n\t\tfragment GroupFragment on Group {\n\t\t\tid\n\t\t\tdescription\n\t\t\tname\n\t\t\torder\n\t\t\tvisible\n\t\t\tslug\n\t\t}\n\t"])))},et={getGroups:function(){return n.gql(j||(j=I(["\n\t\t\tquery GetMenu {\n\t\t\t\tgroups {\n\t\t\t\t\t...GroupFragment\n\t\t\t\t\tdishes {\n\t\t\t\t\t\t...DishFragment\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t","\n\t\t\t","\n\t\t"],["\n\t\t\tquery GetMenu {\n\t\t\t\tgroups {\n\t\t\t\t\t...GroupFragment\n\t\t\t\t\tdishes {\n\t\t\t\t\t\t...DishFragment\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t","\n\t\t\t","\n\t\t"])),tt.group,J.dish)},getGroupsAndDishes:function(){return n.gql(O||(O=I(["\n\t\t\tquery GetGroupsAndDishes {\n\t\t\t\tgroups {\n\t\t\t\t\tparentGroup {\n\t\t\t\t\t\tid\n\t\t\t\t\t}\n\t\t\t\t\t...GroupFragment\n\t\t\t\t}\n\t\t\t\tdishes {\n\t\t\t\t\t...DishFragment\n\t\t\t\t}\n\t\t\t}\n\t\t\t","\n\t\t\t","\n\t\t"],["\n\t\t\tquery GetGroupsAndDishes {\n\t\t\t\tgroups {\n\t\t\t\t\tparentGroup {\n\t\t\t\t\t\tid\n\t\t\t\t\t}\n\t\t\t\t\t...GroupFragment\n\t\t\t\t}\n\t\t\t\tdishes {\n\t\t\t\t\t...DishFragment\n\t\t\t\t}\n\t\t\t}\n\t\t\t","\n\t\t\t","\n\t\t"])),tt.group,J.dish)}},nt={navigation:n.gql(H||(H=I(["\n\t\tfragment NavigationFragment on Navigation {\n\t\t\tid \n\t\t\tname\n\t\t\tdescription\n\t\t\tdata {\n\t\t\t\tlabel\n\t\t\t\tlink\n\t\t\t\ttimeWork\n\t\t\t\tphone\n\t\t\t\ticon\n\t\t\t\tactive\n\t\t\t\tslug\n\t\t\t\tchild {\n\t\t\t\t\ttags\n\t\t\t\t\tslug\n\t\t\t\t\tvisible\n\t\t\t\t\tname\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t"],["\n\t\tfragment NavigationFragment on Navigation {\n\t\t\tid \n\t\t\tname\n\t\t\tdescription\n\t\t\tdata {\n\t\t\t\tlabel\n\t\t\t\tlink\n\t\t\t\ttimeWork\n\t\t\t\tphone\n\t\t\t\ticon\n\t\t\t\tactive\n\t\t\t\tslug\n\t\t\t\tchild {\n\t\t\t\t\ttags\n\t\t\t\t\tslug\n\t\t\t\t\tvisible\n\t\t\t\t\tname\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t"])))},rt={getNavigationes:function(){return n.gql(B||(B=I(["\n\t\t\tquery GetNavigation {\n\t\t\t\tnavigation {\n\t\t\t\t\t...NavigationFragment\n\t\t\t\t}\n\t\t\t}\n\t\t\t","\n\t\t"],["\n\t\t\tquery GetNavigation {\n\t\t\t\tnavigation {\n\t\t\t\t\t...NavigationFragment\n\t\t\t\t}\n\t\t\t}\n\t\t\t","\n\t\t"])),nt.navigation)}},it={paymentMethod:n.gql(N||(N=I(["\n\t\tfragment PaymentMethodFragment on PaymentMethod {\n\t\t\tid\n\t\t\ttype\n\t\t\ttitle\n\t\t\tdescription\n\t\t\tadapter\n\t\t\torder\n\t\t\tenable\n\t\t\tcustomData\n\t\t}\n\t"],["\n\t\tfragment PaymentMethodFragment on PaymentMethod {\n\t\t\tid\n\t\t\ttype\n\t\t\ttitle\n\t\t\tdescription\n\t\t\tadapter\n\t\t\torder\n\t\t\tenable\n\t\t\tcustomData\n\t\t}\n\t"])))},ot={getPaymentMethod:function(t){void 0===t&&(t=null),"null"==t&&(t=null);var e=t?'(cartId: "'+t+'")':"";return n.gql(Q||(Q=I(["\n\t\t\t\tquery GetPaymentMethods {\n\t\t\t\t\tpaymentMethods:paymentMethod"," {\n\t\t\t\t\t\t...PaymentMethodFragment\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t"],["\n\t\t\t\tquery GetPaymentMethods {\n\t\t\t\t\tpaymentMethods:paymentMethod"," {\n\t\t\t\t\t\t...PaymentMethodFragment\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t","\n\t\t\t"])),e,it.paymentMethod)}},st=function(){function t(t){this.apollo=t,this.menu$=new r.BehaviorSubject(null),this.dishes$=new r.BehaviorSubject(null),this.cart$=new r.BehaviorSubject(null),this.navigationData$=new r.BehaviorSubject(null),this.customQueryiesDataByName={},this.customQueriesDataLoadingByName={},this.cart$.subscribe((function(t){return console.log("control cart res",t)}))}return t.prototype.getNavigation$=function(){var t=this;return this.navigationData$.getValue()||this.navigationDataLoading||this.apollo.watchQuery({query:rt.getNavigationes()}).valueChanges.pipe(i.tap((function(e){var n,r,i=e.data,o=e.loading;t.menuLoading=o;var s={};try{for(var a=C(i.navigation),d=a.next();!d.done;d=a.next()){var h=d.value;s[h.name]=h}}catch(t){n={error:t}}finally{try{d&&!d.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}t.navigationData$.next(s)}))).subscribe(),this.navigationData$},t.prototype.getMenu$=function(t){var e=this;return void 0===t&&(t=null),this.menu$.getValue()||this.menuLoading||this.apollo.watchQuery({query:et.getGroupsAndDishes()}).valueChanges.pipe(i.tap((function(n){var r,i,o,s,a,d,h=n.data,c=n.loading;e.menuLoading=c;var u=h.groups,p=h.dishes,m={},l=null;try{for(var f=C(u),g=f.next();!g.done;g=f.next()){m[(D=g.value).id]=Object.assign(Object.assign({},D),{dishes:[],childGroups:[]})}}catch(t){r={error:t}}finally{try{g&&!g.done&&(i=f.return)&&i.call(f)}finally{if(r)throw r.error}}try{for(var v=C(p),y=v.next();!y.done;y=v.next()){var I=y.value;(M=null===(a=I.parentGroup)||void 0===a?void 0:a.id)&&(m[M]&&m[M].dishes.push(I))}}catch(t){o={error:t}}finally{try{y&&!y.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}for(var M in m){var D,$=null===(d=(D=m[M]).parentGroup)||void 0===d?void 0:d.id;$&&(m[$]&&(m[$].childGroups.push(D),t&&D.slug==t?l=M:delete m[M]))}if(t)return l?void e.menu$.next(m[l].childGroups):void e.menu$.next([]);var b=Object.values(m).sort((function(t,e){return t.order-e.order}));e.menu$.next(b)}))).subscribe(),this.menu$},t.prototype.getDishes$=function(){var t=this;return this.dishes$.getValue()||this.dishesLoading||this.apollo.watchQuery({query:U.getDishes()}).valueChanges.pipe(i.tap((function(e){var n=e.data,r=e.loading;t.dishesLoading=r,t.dishes$.next(n.dishes)}))).subscribe(),this.dishes$},t.prototype.getCart$=function(t){var e=this;return void 0===t&&(t=null),this.cart$.getValue()||this.cartLoading||this.apollo.watchQuery({query:Y.getCart(t)}).valueChanges.pipe(i.take(1),i.tap((function(t){var n=t.data,r=t.loading;e.cartLoading=r,e.cart$.next(n.cart)}))).subscribe(),this.cart$},t.prototype.getPhone$=function(t){var e=this;return this.apollo.watchQuery({query:Y.getPhone(t)}).valueChanges.pipe(i.map((function(t){var n=t.data,r=t.loading;return e.getPhoneLoading=r,n.phone})))},t.prototype.checkPhone$=function(t){var e=this;return this.apollo.watchQuery({query:Y.checkPhone(t)}).valueChanges.pipe(i.map((function(t){var n=t.data,r=t.loading;return e.checkPhoneLoading=r,n.checkPhone})))},t.prototype.getPaymentMethods$=function(t){var e=this;return this.apollo.watchQuery({query:ot.getPaymentMethod(t)}).valueChanges.pipe(i.map((function(t){var n=t.data,r=t.loading;return e.paymentMethodLoading=r,n.paymentMethods})))},t.prototype.addDishToCart$=function(t){var e=this;return this.apollo.mutate({mutation:Z.addDishToCart(),variables:t}).pipe(i.map((function(t){var n=t.data.cartAddDish;return e.cart$.next(n),n})))},t.prototype.orderCart$=function(t){var e=this;return this.apollo.mutate({mutation:Z.orderCart(),variables:t}).pipe(i.map((function(t){var n=t.data.orderCart;return e.cart$.next(n.cart),n})))},t.prototype.checkCart$=function(t){var e=this;return this.apollo.mutate({mutation:Z.checkCart(),variables:t}).pipe(i.map((function(t){var n=t.data.checkCart;return e.cart$.next(n.cart),n})))},t.prototype.checkPhoneCode$=function(t){return this.apollo.mutate({mutation:Z.checkPhoneCode(),variables:t}).pipe(i.map((function(t){return t.data.checkPhoneCode})))},t.prototype.removeDishFromCart$=function(t){var e=this;return this.apollo.mutate({mutation:Z.removeDishFromCart(),variables:t}).pipe(i.map((function(t){var n=t.data.cartAddDish;return e.cart$.next(n),n})))},t.prototype.customQuery$=function(t,e,o){var s=this;void 0===o&&(o={});var a=[];for(var d in o){var h=o[d];"number"!=typeof h&&"boolean"!=typeof h&&(h='"'+h+'"'),a.push(d+": "+h)}var c=a.length?"("+a.join(", ")+")":"",u=JSON.stringify(e).replace(/"/g,"").replace(/\:[a-z0-9]+/gi,"").replace(/\:/g,"");return this.customQueryiesDataByName[t]||(this.customQueryiesDataByName[t]=new r.BehaviorSubject(null),this.customQueriesDataLoadingByName[t]=!1),this.customQueryiesDataByName[t].getValue()||this.customQueriesDataLoadingByName[t]||this.apollo.watchQuery({query:n.gql(R||(R=I(["query ","","",""],["query ","","",""])),t,c,u)}).valueChanges.pipe(i.tap((function(e){var n=e.data,r=e.loading;s.customQueriesDataLoadingByName[t]=r,s.customQueryiesDataByName[t].next(n)}))).subscribe(),this.customQueryiesDataByName[t].pipe(i.filter((function(t){return!!t})))},t.prototype.customMutation$=function(t,e,r){void 0===r&&(r={});var i=[];for(var o in r){var s=r[o];"number"!=typeof s&&"boolean"!=typeof s&&(s='"'+s+'"'),i.push(o+": "+s)}var a=i.length?"("+i.join(", ")+")":"",d=JSON.stringify(e).replace(/"/g,"").replace(/\:[a-z0-9]+/gi,"").replace(/\:/g,"");return this.apollo.mutate({mutation:n.gql(W||(W=I(["mutation ","","",""],["mutation ","","",""])),t,a,d)})},t}();st.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new st(e.ɵɵinject(n.Apollo))},token:st,providedIn:"root"}),st.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],st.ctorParameters=function(){return[{type:n.Apollo}]};var at=function(){function t(){this.eventMessage=new e.EventEmitter,this.eventAction=new e.EventEmitter}return t.prototype.emitMessageEvent=function(t){this.eventMessage.emit(t)},t.prototype.emitActionEvent=function(t){this.eventAction.emit(t)},t.prototype.getMessageEmitter=function(){return this.eventMessage},t.prototype.getActionEmitter=function(){return this.eventAction},t}();at.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new at},token:at,providedIn:"root"}),at.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],at.ctorParameters=function(){return[]};var dt="cartId",ht=function(){function t(t,e){var n=this;this.ngGqlService=t,this.eventer=e,this.OrderFormChange=new r.BehaviorSubject(null),this.cart=new r.BehaviorSubject({}),this.initialStorage(),this.modifiers$=new r.BehaviorSubject([]),this.modifiersMessage$=new r.BehaviorSubject([]),this.modifiersMessage$.subscribe((function(t){return n.messages=t}))}return t.prototype.getCartId=function(){return localStorage.getItem(dt)},t.prototype.setCartId=function(t){if(!t)return null;localStorage.setItem(dt,t)},t.prototype.removeCartId=function(){localStorage.removeItem(dt)},t.prototype.userCart$=function(){return this.cart.pipe(i.filter((function(t){return!!t})))},t.prototype.setModifiers=function(t,e){this.modifiers$.next(t),e&&this.modifiersMessage$.next(e)},t.prototype.getModifiers=function(){return this.modifiers$},t.prototype.initialStorage=function(){var t=this;this.cartId=this.getCartId(),this.ngGqlService.getCart$(this.cartId).pipe(i.tap((function(e){console.log("cart tap",e),"ORDER"==(null==e?void 0:e.state)&&r.throwError(new Error("Cart in order state")),t.setCartId(null==e?void 0:e.id)}))).subscribe((function(e){return t.cart.next(e)}),(function(e){return t.removeCartId()}))},t.prototype.addDishToCart$=function(t){var e=this;return this.messages.length&&this.messages.forEach((function(t){e.eventer.emitMessageEvent(t)})),this.ngGqlService.addDishToCart$(t)},t.prototype.removeDishFromCart$=function(t,e){return this.ngGqlService.removeDishFromCart$({cartDishId:t,cartId:this.cartId,amount:e})},t.prototype.orderCart$=function(t){return this.ngGqlService.orderCart$(t)},t.prototype.checkCart$=function(t){return console.log("Check cart$",t),this.ngGqlService.checkCart$(t)},t.prototype.setDishCountToCart=function(t,e){console.log("setDishCountToCart")},t.prototype.setDishComment=function(t,e){return console.log("setDishComment"),r.of(null)},t}();ht.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new ht(e.ɵɵinject(st),e.ɵɵinject(at))},token:ht,providedIn:"root"}),ht.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],ht.ctorParameters=function(){return[{type:st},{type:at}]};var ct=function(){function t(t){var n=this;this.cartService=t,this.loading=new e.EventEmitter,this.success=new e.EventEmitter,this.error=new e.EventEmitter,this.cartService.userCart$().subscribe((function(t){return n.cart=t})),this.cartService.getModifiers().subscribe((function(t){return n.modifiers=t}))}return t.prototype.onClick=function(){this.addDishToCart(this.dish.id,this.amountDish)},t.prototype.addDishToCart=function(t,e){var n=this,r={dishId:t,amount:e,cartId:void 0,modifiers:this.modifiers,comment:this.comment,replace:!!this.replaceCartDishId||void 0,cartDishId:this.replaceCartDishId};console.log("this.cart",this.cart),console.log("this.modifiers",this.modifiers),this.cart.id&&(r.cartId=this.cart.id),this.loading.emit(!0),this.cartService.addDishToCart$(r).subscribe((function(t){return n.success.emit(!0)}),(function(t){return n.error.emit(t)}),(function(){n.loading.emit(!1)}))},t}();ct.decorators=[{type:e.Directive,args:[{selector:"[addToCart]"}]}],ct.ctorParameters=function(){return[{type:ht}]},ct.propDecorators={dish:[{type:e.Input}],amountDish:[{type:e.Input}],comment:[{type:e.Input}],replaceCartDishId:[{type:e.Input}],loading:[{type:e.Output}],success:[{type:e.Output}],error:[{type:e.Output}],onClick:[{type:e.HostListener,args:["click"]}]};var ut=function(t,e,n){var r=this;this.cartService=t,this.renderer=e,this.el=n,this.amount="0",this.renderer.setProperty(this.el.nativeElement,"innerHTML",this.amount),this.cartService.userCart$().subscribe((function(t){r.cart=t,r.amount=t.dishesCount||0,r.renderer.setProperty(r.el.nativeElement,"innerHTML",r.amount)}))};ut.decorators=[{type:e.Directive,args:[{selector:"[amountCart]"}]}],ut.ctorParameters=function(){return[{type:ht},{type:e.Renderer2},{type:e.ElementRef}]};var pt=function(){function t(t){var e=this;this.cartService=t,this.cartService.userCart$().subscribe((function(t){return e.cart=t}))}return t.prototype.onClick=function(){this.cartService.removeDishFromCart$(this.dish.id,this.amountDish).subscribe()},t}();pt.decorators=[{type:e.Directive,args:[{selector:"[deleteFromCart]"}]}],pt.ctorParameters=function(){return[{type:ht}]},pt.propDecorators={dish:[{type:e.Input}],amountDish:[{type:e.Input}],onClick:[{type:e.HostListener,args:["click"]}]};var mt=function(){function t(t){this.cartService=t,this.requiredFields=["name","phone","street","house"],this.checkerFields=new r.BehaviorSubject(void 0)}return t.prototype.onClick=function(){this.order(this.orderCart.value),console.log(this.orderCart.value)},t.prototype.ngAfterViewInit=function(){var t=this;setTimeout((function(){t.cartService.userCart$().subscribe((function(e){t.cart&&t.orderCart.valid&&t.cart.cartTotal!=e.cartTotal&&e.cartTotal>0&&t.checkStreet(t.orderCart.value),t.cart=e}))}),100),setTimeout((function(){t.checkerFields.next(t.checkForFields(t.orderCart._directives,t.requiredFields))}),100),this.checkerFields.subscribe((function(e){e&&(t.orderCart.controls.street.valueChanges.subscribe((function(e){"object"==typeof e&&setTimeout((function(){t.orderCart.controls.house.valid&&(t.orderCart.value.name=t.orderCart.value.name||"Неуказано",t.orderCart.value.phone=t.orderCart.value.phone||"78888888888",t.checkStreet(t.orderCart.value))}),100)})),t.orderCart.controls.house.valueChanges.subscribe((function(e){setTimeout((function(){t.orderCart.controls.street.valid&&(t.orderCart.value.name=t.orderCart.value.name||"Неуказано",t.orderCart.value.phone=t.orderCart.value.phone||"78888888888",t.checkStreet(t.orderCart.value))}),100)})))}))},t.prototype.checkForFields=function(t,e){var n={},r=[];return t.forEach((function(t){n[t.name]=!0})),e.forEach((function(t){n.hasOwnProperty(t)||r.push(t)})),r.length<=0||(console.error("У формы отсутсвуют следующие обязательные для корректной работы модуля поля:",r),!1)},t.prototype.order=function(t){if(this.checkForFields(this.orderCart._directives,this.requiredFields)){var e=void 0,n=t.comment||"Не указан";e=t.cash?"Наличными курьеру":t.bankcard?"Банковской картой курьеру":"Не указан",console.log(t);var r={cartId:this.cart.id,comment:"\n Тип оплаты:"+e+"\nКоментарий:"+n,address:{streetId:t.street.id,home:t.house,housing:t.housing,doorphone:t.doorphone,entrance:t.entrance,floor:t.floor,apartment:t.apartment},customer:{phone:"+"+t.phone,mail:t.email,name:t.name},personsCount:t.personsCount};this.cartService.orderCart$(r).subscribe()}},t.prototype.checkStreet=function(t){if(console.log(">>>>",t),this.checkForFields(this.orderCart._directives,this.requiredFields))this.cart.id,t.comment,t.street.id,t.house,t.housing,t.doorphone,t.entrance,t.floor,t.apartment,t.phone,t.email,t.name,t.personsCount},t.prototype.stringToNumber=function(t){return console.log(typeof t),"string"==typeof t?+t:"number"==typeof t?t:void console.error("Параметр home должен быть или string или number")},t}();mt.decorators=[{type:e.Directive,args:[{selector:"[orderCart]"}]}],mt.ctorParameters=function(){return[{type:ht}]},mt.propDecorators={orderCart:[{type:e.Input}],onClick:[{type:e.HostListener,args:["click"]}]};var lt=function(){function t(t){var e=this;this.cartService=t,this.cartService.userCart$().subscribe((function(t){return e.cart=t}))}return t.prototype.onClick=function(){this.changeAmount(this.action)},t.prototype.changeAmount=function(t){switch(t){case"+":this.cartService.setDishCountToCart(this.dish.id,this.dish.amount+1);break;case"-":this.cartService.setDishCountToCart(this.dish.id,this.dish.amount-1);break;default:console.log("Директива SetDishAmount получила ложное значение action")}},t}();lt.decorators=[{type:e.Directive,args:[{selector:"[setDishAmount]"}]}],lt.ctorParameters=function(){return[{type:ht}]},lt.propDecorators={action:[{type:e.Input}],dish:[{type:e.Input}],onClick:[{type:e.HostListener,args:["click"]}]};var ft=function(){function t(t,n,r){this.renderer=t,this.el=n,this.cartService=r,this.validate=new e.EventEmitter,this.amountDishToAdd=new e.EventEmitter,this.amountModifiers={},this.stateModifiers={}}return t.prototype.ngOnInit=function(){var t=this;this.renderer.addClass(this.el.nativeElement,"dish-calculator"),this.amountDish=this.amount,this.amountDishToAdd.emit(this.amountDish),this.price=this.renderer.createElement("div"),this.renderer.addClass(this.price,"dish-price"),setTimeout((function(){t.renderDish(t.dish),t.render(t.dish.modifiers)}),100)},t.prototype.renderDish=function(t){var e=this,n=this.renderer.createElement("div");this.renderer.addClass(n,"dish-wraper"),this.renderer.appendChild(this.el.nativeElement,n);var r=this.renderer.createElement("div");this.renderer.addClass(r,"name"),this.renderer.appendChild(n,r);var i=this.renderer.createElement("div");this.renderer.addClass(i,"title"),this.renderer.setProperty(i,"innerHTML",this.dish.name),this.renderer.appendChild(r,i);var o=this.renderer.createElement("div");this.renderer.addClass(r,"weight"),this.renderer.addClass(r,"dish"),this.renderer.appendChild(n,o);var s=this.renderer.createElement("div");this.renderer.addClass(s,"value"),this.renderer.setProperty(s,"innerHTML",(1e3*this.dish.weight).toFixed(0)+" г."),0!==this.dish.weight&&this.dish.weight||this.renderer.addClass(s,"zero"),this.renderer.appendChild(o,s),this.renderer.setProperty(this.price,"innerHTML",this.dish.price);var a=this.renderer.createElement("div");this.renderer.addClass(a,"price"),this.renderer.addClass(a,"total"),this.renderer.appendChild(a,this.price),this.renderer.appendChild(n,a);var d=this.renderer.createElement("div");this.renderer.addClass(d,"quantity"),this.renderer.appendChild(n,d);var h=this.renderer.createElement("a");this.renderer.addClass(h,"quantity__button"),this.renderer.addClass(h,"minus"),this.renderer.setProperty(h,"innerHTML","&#8722;"),this.renderer.listen(h,"click",(function(t){e.changeAmountdish(-1),e.renderer.setProperty(c,"innerHTML",e.amountDish),e.renderer.setProperty(e.price,"innerHTML",e.generatePrice(e.dish.price)),e.innerTotalWeight(m)})),this.renderer.appendChild(d,h);var c=this.renderer.createElement("span");this.renderer.addClass(c,"quantity__counter"),this.renderer.setProperty(c,"innerHTML",this.amountDish),this.renderer.appendChild(d,c);var u=this.renderer.createElement("a");this.renderer.addClass(u,"quantity__button"),this.renderer.addClass(h,"plus"),this.renderer.setProperty(u,"innerHTML","&#x2b;"),this.renderer.listen(u,"click",(function(t){e.changeAmountdish(1),e.renderer.setProperty(c,"innerHTML",e.amountDish),e.renderer.setProperty(e.price,"innerHTML",e.generatePrice(e.dish.price)),e.innerTotalWeight(m)})),this.renderer.appendChild(d,u);var p=this.renderer.createElement("div");this.renderer.addClass(r,"weight"),this.renderer.addClass(r,"total"),this.renderer.appendChild(n,p);var m=this.renderer.createElement("div");0!==this.dish.weight&&this.dish.weight||this.renderer.addClass(m,"zero"),this.renderer.addClass(m,"value"),this.innerTotalWeight(m),this.renderer.appendChild(p,m),this.weightTotal=m,this.renderer.setProperty(this.price,"innerHTML",this.generatePrice(t.price));var l=this.renderer.createElement("div");this.renderer.addClass(l,"price"),this.renderer.addClass(l,"total"),this.renderer.appendChild(l,this.price),this.renderer.appendChild(n,l)},t.prototype.generatePrice=function(t,e,n){var r=this,i=[];this.selectedModifiers&&this.selectedModifiers.forEach((function(t){r.dish.modifiers.forEach((function(e){var n=e.childModifiers.filter((function(e){return e.modifierId===t.id}));n.length>0&&(n[0].groupId=e.group.id,i.push(n[0]))}))}));var o=0;return i.forEach((function(t){o+=t.dish.price*r.amountModifiers[t.groupId][t.modifierId]})),o*=this.amountDish,t*this.amountDish+o+'<div class="currency">&nbsp;&#x20bd;</div>'},t.prototype.generateTotalWeight=function(){var t=this,e=[];this.selectedModifiers&&this.selectedModifiers.forEach((function(n){t.dish.modifiers.forEach((function(t){var r=t.childModifiers.filter((function(t){return t.modifierId===n.id}));r.length>0&&(r[0].groupId=t.group.id,e.push(r[0]))}))}));var n=0;return e.forEach((function(e){n+=e.dish.weight*t.amountModifiers[e.groupId][e.modifierId]*1e3})),n=parseFloat((n*this.amountDish).toFixed(2)),console.log(n,1e3*this.dish.weight*this.amountDish),console.log(this.dish.weight,this.amountDish),(1e3*this.dish.weight*this.amountDish+n).toFixed(0)+" г. <div class='separator'></div>"},t.prototype.innerTotalWeight=function(t){this.renderer.setProperty(t,"innerHTML",this.generateTotalWeight())},t.prototype.changeAmountdish=function(t){this.amountDish=this.amountDish+t,this.amountDish<=0&&(this.amountDish=1),this.amountDish>=199&&(this.amountDish=199),this.amountDishToAdd.emit(this.amountDish)},t.prototype.render=function(t){var e=this;if(this.setModifiers(),t.length>0){var n=this.renderer.createElement("h5");this.renderer.setProperty(n,"innerHTML","К этому блюду можно добавить:")}if(t.forEach((function(t){if(e.stateModifiers[t.modifierId]={},e.amountModifiers[t.modifierId]={},t.dish){var n=e.groupDiv("Одночные модификаторы не поддерживаются");e.renderer.appendChild(e.el.nativeElement,n),console.log("elementGroup",t)}else if(t.childModifiers){var r=e.groupDiv(t.group?t.group.name:"Ошибка");e.renderer.appendChild(e.el.nativeElement,r),t.childModifiers.forEach((function(n){var i=e.modifireDiv(n,t.modifierId);e.renderer.appendChild(r,i),n.defaultAmount<1?e.stateModifiers[t.modifierId][n.modifierId]=!1:e.stateModifiers[t.modifierId][n.modifierId]=!0}))}})),t.length>0){n=this.renderer.createElement("div");this.renderer.setProperty(n,"innerHTML","<p>* — Количество добавленых опций блюда применяется для каждой порции</p>"),this.renderer.appendChild(this.el.nativeElement,n)}},t.prototype.groupDiv=function(t){var e=this.renderer.createElement("div");return this.renderer.addClass(e,"group-modifiers-wraper"),this.renderer.appendChild(e,this.renderer.createText(""+t)),e},t.prototype.modifireDiv=function(t,e){var n=this.renderer.createElement("div");return this.renderer.addClass(n,"additional-item"),this.renderOneModifire(t,n,e),n},t.prototype.renderOneModifire=function(t,e,n){console.info("renderOneModifire",t),console.info("renderOneModifire selectedModifiers",this.selectedModifiers);var r=this.renderer.createElement("div");this.renderer.addClass(r,"item-name");var i=this.renderer.createElement("label");this.renderer.setAttribute(i,"for",t.modifierId),this.renderer.appendChild(r,i),this.renderer.setProperty(i,"innerHTML",t.dish.name),this.renderer.appendChild(e,r);var o=this.renderer.createElement("div");this.renderer.addClass(o,"left-weight-modifire-wraper");var s=this.renderer.createElement("div");this.renderer.addClass(s,"weight"),(0===t.dish.weight||t.dish.weight<0)&&this.renderer.addClass(s,"zero"),this.renderer.setProperty(s,"innerHTML",(1e3*t.dish.weight).toFixed(0)+" г."),this.renderer.appendChild(o,s),this.renderer.appendChild(e,o);var a=this.renderer.createElement("div"),d=t.minAmount,h=t.maxAmount,c=t.defaultAmount;switch(console.info("min max def",d,h,c),!0){case 0===d&&0===h&&0===c:case 0===d&&1===h&&0===c:this.renderCheckbox(t,!1,a,e,n);break;case 0===d&&1===h&&1===c:this.renderCheckbox(t,!0,a,e,n);break;case 1===d&&1===h&&1===c:console.error(t.dish.name,"Значение не поддается настройке:",d,h,c);break;case d<=h&&c>=d&&c<=h&&h>1:this.renderInputButton(t,n,a,e);break;default:console.error(t.dish.name,"Ошибка рендера модификатора, для значений:",d,h,c)}t.maxAmount>0&&t.minAmount;var u=this.renderer.createElement("div");this.renderer.addClass(u,"right-weight-modifire-wraper");var p=this.renderer.createElement("div");this.renderer.addClass(p,"weight"),(0===t.dish.weight||t.dish.weight<0)&&this.renderer.addClass(p,"zero"),this.renderer.setProperty(p,"innerHTML",(1e3*t.dish.weight).toFixed(0)+' г.<div class="separator"></div>'),this.renderer.appendChild(u,p),this.renderer.appendChild(e,u);var m,l=this.renderer.createElement("div");this.renderer.addClass(l,"item-price"),t.dish.price>0?(m=t.dish.price+"<div class = 'currency'>&nbsp;&#x20bd;</div>",this.renderer.setProperty(l,"innerHTML",m),this.renderer.appendChild(e,l)):this.renderer.addClass(l,"zero-price"),this.setModifiers(),this.innerTotalWeight(this.weightTotal),this.renderer.setProperty(this.price,"innerHTML",this.generatePrice(this.dish.price))},t.prototype.renderCheckbox=function(t,e,n,r,i){var o=this,s=this.renderer.createElement("input");this.renderer.setAttribute(s,"type","checkbox"),this.renderer.setAttribute(s,"id",t.modifierId),e?(this.renderer.setProperty(s,"checked",!0),t.checked=!0,this.stateModifiers[i][t.modifierId]=!0,this.amountModifiers[i][t.modifierId]=1):(t.checked=!1,this.stateModifiers[i][t.modifierId]=!1,this.amountModifiers[i][t.modifierId]=0),this.renderer.addClass(s,"modal-checkbox"),this.renderer.appendChild(n,s),this.renderer.listen(s,"change",(function(t){if(o.idRadioBox(i)){for(var e in o.stateModifiers[i])o.stateModifiers[i].hasOwnProperty(e)&&(o.stateModifiers[i][e]=!1);t.target.parentElement.parentElement.parentElement.querySelectorAll("input").forEach((function(e){e.id!=t.target.id&&(e.checked=!1)}))}o.stateModifiers[i][t.target.id]=t.target.checked,t.target.checked&&(o.amountModifiers[i][t.target.id]=1),o.setModifiers(),o.innerTotalWeight(o.weightTotal),o.renderer.setProperty(o.price,"innerHTML",o.generatePrice(o.dish.price))})),this.renderer.appendChild(r,n)},t.prototype.renderInputButton=function(t,e,n,r){var i,o=this;(i=t.defaultAmount>0?t.defaultAmount:t.minAmount)>0&&(this.stateModifiers[e][t.modifierId]=!0);var s=this.renderer.createElement("a");this.renderer.addClass(s,"quantity__button"),this.renderer.setProperty(s,"innerHTML","&#8722;"),this.renderer.appendChild(n,s),this.renderer.listen(s,"click",(function(n){var r=+o.amountModifiers[e][t.modifierId];o.amountModifiers[e][t.modifierId]=r-1,o.amountModifiers[e][t.modifierId]<t.minAmount&&(o.amountModifiers[e][t.modifierId]=t.minAmount),o.renderer.setProperty(a,"innerHTML",o.amountModifiers[e][t.modifierId]),0===o.amountModifiers[e][t.modifierId]&&(o.stateModifiers[e][t.modifierId]=!1),o.setModifiers(),o.innerTotalWeight(o.weightTotal),o.renderer.setProperty(o.price,"innerHTML",o.generatePrice(o.dish.price))}));var a=this.renderer.createElement("span");this.renderer.addClass(a,"item-quantity__counter"),this.amountModifiers[e][t.modifierId]=i,this.renderer.setProperty(a,"innerHTML",this.amountModifiers[e][t.modifierId]),this.renderer.appendChild(n,a);var d=this.renderer.createElement("a");this.renderer.addClass(d,"quantity__button"),this.renderer.setProperty(d,"innerHTML","&#x2b;"),this.renderer.appendChild(n,d),this.renderer.appendChild(r,n),this.renderer.listen(d,"click",(function(n){var r=+o.amountModifiers[e][t.modifierId];o.amountModifiers[e][t.modifierId]=r+1,o.amountModifiers[e][t.modifierId]>t.maxAmount&&0!=t.maxAmount&&(o.amountModifiers[e][t.modifierId]=t.maxAmount),o.renderer.setProperty(a,"innerHTML",o.amountModifiers[e][t.modifierId]),o.amountModifiers[e][t.modifierId]>0&&(o.stateModifiers[e][t.modifierId]=!0),o.setModifiers(),o.innerTotalWeight(o.weightTotal),o.renderer.setProperty(o.price,"innerHTML",o.generatePrice(o.dish.price))}))},t.prototype.setModifiers=function(){var t=this,e=[],n=[];for(var r in console.info("setModifiers modifiersToSelect",e),console.info("setModifiers stateModifiers before",this.stateModifiers),console.info("setModifiers selectedModifiers before",this.selectedModifiers),this.stateModifiers){var i=function(t){(o.stateModifiers[r][t]||e.find((function(e){return e.modifierId==t})))&&n.push({id:t,amount:o.amountModifiers[r][t],groupId:r})},o=this;for(var s in this.stateModifiers[r])i(s)}if(this.selectedModifiers=n,this.dish.modifiers.length>0){var a=[];this.dish.modifiers.forEach((function(e){if(e.required)if(t.stateModifiers[e.modifierId]){var r=[],i=t.stateModifiers[e.modifierId];for(var o in i)i.hasOwnProperty(o)&&i[o]&&r.push(i[o]);r.length<e.minAmount?(a.push({type:"warning",title:"Внимание",body:" Обязательно выберите модификаторы из категории: "+e.group.name}),t.validate.emit(!1),t.cartService.setModifiers(n,a)):(t.validate.emit(!0),t.cartService.setModifiers(n,[]))}else a.push({type:"warning",title:"Внимание",body:" Обязательно выберите модификаторы из категории: "+e.group.name}),t.validate.emit(!1),t.cartService.setModifiers(n,a);else t.validate.emit(!0),t.cartService.setModifiers(n)}))}else this.validate.emit(!0),this.cartService.setModifiers(n,[]);console.info("setModifiers stateModifiers after",this.stateModifiers),console.info("setModifiers selectedModifiers after",this.selectedModifiers)},t.prototype.idRadioBox=function(t){var e=this.dish.modifiers.find((function(e){return e.modifierId===t}));return 1===e.minAmount&&1===e.maxAmount},t.prototype.checkMinAmountModifiers=function(t,e){},t.prototype.ngOnDestroy=function(){this.validate.emit(!0),this.cartService.setModifiers([],[])},t}();ft.decorators=[{type:e.Directive,args:[{selector:"[dishCalc]"}]}],ft.ctorParameters=function(){return[{type:e.Renderer2},{type:e.ElementRef},{type:ht}]},ft.propDecorators={dish:[{type:e.Input}],amount:[{type:e.Input}],selectedModifiers:[{type:e.Input}],validate:[{type:e.Output}],amountDishToAdd:[{type:e.Output}]};var gt=function(){function t(t){var n=this;this.cartService=t,this.success=new e.EventEmitter,this.error=new e.EventEmitter,this.isChecking=new e.EventEmitter,this.cartService.userCart$().subscribe((function(t){return n.cart=t})),this.cartService.OrderFormChange.pipe(i.filter((function(){if(n.locationId||(n.streetId||n.street)&&n.home||n.selfService)return!0})),i.debounceTime(1e3)).subscribe((function(){return n.checkStreet()}))}return t.prototype.onClick=function(){var t=this;if(this.locationId||(this.streetId||this.street)&&this.home||this.selfService){this.comment,this.paymentMethod;var e={cartId:this.cart.id,customer:{phone:this.preparePhone(this.phone),mail:this.email,name:this.name}};this.paymentMethodId&&(e.paymentMethodId=this.paymentMethodId),e.selfService=this.selfService,this.locationId||(e.address={streetId:this.streetId,street:this.street,home:this.home,housing:this.housing,doorphone:this.doorphone||"",entrance:this.entrance||"",floor:this.floor||"",apartment:this.apartment||""});var n=this.cart.id;this.cartService.orderCart$(e).subscribe((function(e){e.action&&e.action.paymentRedirect?window.location.href=e.action.paymentRedirect:t.success.emit(n)}),(function(e){return t.error.emit(e)}))}else this.error.emit("Нужно указать адрес")},t.prototype.ngOnChanges=function(t){this.cartService.OrderFormChange.next(t)},t.prototype.checkStreet=function(){var t=this,e=this.comment||"Не указан",n=(this.paymentMethod,{cartId:this.cart.id,comment:e,customer:{phone:this.phone?this.preparePhone(this.phone):null,mail:this.email,name:this.name||null},personsCount:+this.personsCount});n.selfService=this.selfService,this.paymentMethodId&&(n.paymentMethodId=this.paymentMethodId),this.date&&(n.date=this.date),this.notifyMethodId&&(n.notifyMethodId=this.notifyMethodId),this.locationId?n.locationId=this.locationId:n.address={streetId:this.streetId,street:this.street,home:this.home,housing:this.housing,doorphone:this.doorphone||"",entrance:this.entrance||"",floor:this.floor||"",apartment:this.apartment||""},this.isChecking.emit(!0),this.cartService.checkCart$(n).subscribe((function(e){return t.isChecking.emit(!1)}),(function(e){return t.isChecking.emit(!1)}))},t.prototype.preparePhone=function(t){return t?(t="+"+t.replace(/[^0-9]/gim,"")).replace("+8","+7"):""},t}();gt.decorators=[{type:e.Directive,args:[{selector:"[checkout]"}]}],gt.ctorParameters=function(){return[{type:ht}]},gt.propDecorators={cartTotal:[{type:e.Input}],bonuses:[{type:e.Input}],name:[{type:e.Input}],email:[{type:e.Input}],phone:[{type:e.Input}],delivery:[{type:e.Input}],selfService:[{type:e.Input}],locationId:[{type:e.Input}],street:[{type:e.Input}],streetId:[{type:e.Input}],home:[{type:e.Input}],housing:[{type:e.Input}],apartment:[{type:e.Input}],entrance:[{type:e.Input}],doorphone:[{type:e.Input}],floor:[{type:e.Input}],paymentMethod:[{type:e.Input}],paymentMethodId:[{type:e.Input}],personsCount:[{type:e.Input}],comment:[{type:e.Input}],date:[{type:e.Input}],notifyMethodId:[{type:e.Input}],success:[{type:e.Output}],error:[{type:e.Output}],isChecking:[{type:e.Output}],onClick:[{type:e.HostListener,args:["click"]}]};var vt=function(){function t(t){this.cartService=t,this.success=new e.EventEmitter,this.error=new e.EventEmitter}return t.prototype.onClick=function(){this.setComment()},t.prototype.setComment=function(){var t=this;this.cartService.setDishComment(this.dish.id,this.comment).subscribe((function(e){return t.success.emit(!0)}),(function(e){return t.error.emit(e)}))},t}();vt.decorators=[{type:e.Directive,args:[{selector:"[setDishComment]"}]}],vt.ctorParameters=function(){return[{type:ht}]},vt.propDecorators={comment:[{type:e.Input}],dish:[{type:e.Input}],success:[{type:e.Output}],error:[{type:e.Output}],onClick:[{type:e.HostListener,args:["click"]}]};var yt=[ct,ut,pt,mt,ft,vt,lt,gt],Ct=function(){function t(t,e,n){var r=e.create({uri:n.url}),i=new a.WebSocketLink({uri:n.url.replace("http","ws"),options:{reconnect:!0}}),o=s.split((function(t){var e=t.query,n=d.getMainDefinition(e),r=n.kind,i=n.operation;return"OperationDefinition"===r&&"subscription"===i}),i,r);t.client||t.create({link:o,cache:new s.InMemoryCache})}return t.forRoot=function(e){return{ngModule:t,providers:[{provide:"config",useValue:e}]}},t}();Ct.decorators=[{type:e.NgModule,args:[{imports:[],exports:[yt],declarations:[yt]}]}],Ct.ctorParameters=function(){return[{type:n.Apollo},{type:o.HttpLink},{type:void 0,decorators:[{type:e.Inject,args:["config"]}]}]};var It=function(){this.maintenance$=new r.BehaviorSubject(null)};It.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new It},token:It,providedIn:"root"}),It.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],It.ctorParameters=function(){return[]};var Mt=function(t,e,n){this.type=t,this.title=e,this.body=n};t.AddDishToCartDirective=ct,t.AmountCartDirective=ut,t.Cart=c,t.CartDish=h,t.CheckPhoneResponse=u,t.CheckResponse=p,t.CheckoutDirective=gt,t.DeleteFromCartDirective=pt,t.Dish=l,t.DishCalcDirective=ft,t.EventMessage=Mt,t.EventerService=at,t.Group=f,t.GroupModifier=v,t.Modifier=g,t.NgCartService=ht,t.NgGqlModule=Ct,t.NgGqlService=st,t.OrderCartUserDirective=mt,t.PaymentMethod=y,t.Phone=m,t.SetAmountDirective=lt,t.SetDishCommentDirective=vt,t.StateService=It,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=webresto-ng-gql.umd.min.js.map